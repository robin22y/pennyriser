<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mortgage Overpayment — Pennyriser</title>
  <link rel="stylesheet" href="/assets/styles.css" />
</head>
<body>
  <header class="container"><h1>Pennyriser</h1></header>
  <main class="container">
    <article class="card">
      <h2>Mortgage Overpayment</h2>
      <p class="tldr">Enter your numbers. See your savings (estimate).</p>

      <label>Loan amount (£)</label>
      <input id="loan" type="number" value="250000" min="0" />

      <label>Interest rate (% per year)</label>
      <input id="rate" type="number" value="5" step="0.01" min="0" />

      <label>Term (years)</label>
      <input id="years" type="number" value="25" min="1" />

      <label>Extra monthly payment (£)</label>
      <input id="extra" type="number" value="100" min="0" />

      <button class="btn btn-primary" id="calcBtn">Calculate →</button>
      <div id="result" class="tldr" style="margin-top:12px"></div>

      <p class="small">Educational estimate only. Not advice.</p>
      <p><a class="btn" href="/">Back to Home</a></p>
    </article>
  </main>

  <script>
    function calculate(){
      const loan = +document.getElementById('loan').value || 0;
      const rate = +document.getElementById('rate').value || 0;
      const years= +document.getElementById('years').value || 0;
      const extra = +document.getElementById('extra').value || 0;
      const resultEl = document.getElementById('result');

      if (loan <= 0 || rate < 0 || years <= 0) {
        resultEl.textContent = 'Please enter valid numbers.';
        return;
      }

      const r = rate/100/12;
      const n = years*12;

      // Calculate base monthly payment
      const baseMonthlyPayment = loan * (r * Math.pow(1 + r, n)) / (Math.pow(1 + r, n) - 1);
      
      // Simulate with overpayment
      let balance = loan;
      let months = 0;
      let totalPaid = 0;
      const payment = baseMonthlyPayment + extra;

      while (balance > 0 && months < 1000 * 12) {
          const interest = balance * r;
          let principal = payment - interest;
          if (principal > balance) principal = balance;
          balance -= principal;
          totalPaid += payment;
          months++;
      }
      
      // Original calculation without overpayment
      const originalMonths = years * 12;
      const originalTotalPaid = baseMonthlyPayment * originalMonths;

      const totalSaved = originalTotalPaid - totalPaid;
      const monthsSaved = originalMonths - months;

      const fmt = n => n.toLocaleString(undefined,{maximumFractionDigits:2});
      const monthsToYears = m => `${Math.floor(m/12)} years, ${m%12} months`;
      
      resultEl.innerHTML = `
        <p>Original term: **${monthsToYears(originalMonths)}**</p>
        <p>New term: **${monthsToYears(months)}**</p>
        <p>Time saved: **${monthsToYears(monthsSaved)}**</p>
        <p>Total interest saved: **£${fmt(totalSaved)}**</p>
      `;
    }

    const inputs = document.querySelectorAll('#loan, #rate, #years, #extra');
    inputs.forEach(input => input.addEventListener('input', calculate));
    
    // Run on page load for initial values
    document.addEventListener('DOMContentLoaded', calculate);
</script>
  <!-- Bottom Nav -->
<nav class="bottom-nav" role="navigation" aria-label="Primary">
  <ul>
    <li><a href="/" data-match="/">
      <span class="icon">🏠</span><span>Home</span>
    </a></li>
    <li><a href="/lessons/index.html" data-match="/lessons/">
      <span class="icon">📚</span><span>Lessons</span>
    </a></li>
    <li><a href="/calculators/mortgage-overpayment.html" data-match="/calculators/">
      <span class="icon">🧮</span><span>Calculator</span>
    </a></li>
    <!-- Login / Logout (toggled by nav.js if Firebase available) -->
    <li><a id="bn-login" href="/auth/login.html">
      <span class="icon">🔑</span><span>Log in</span>
    </a></li>
    <li><a id="bn-logout" href="/auth/login.html" hidden>
      <span class="icon">🚪</span><span>Log out</span>
    </a></li>
    <!-- Admin (only shown for admins) -->
    <li><a id="bn-admin" href="/admin/index.html" data-match="/admin/" hidden>
      <span class="icon">🛠️</span><span>Admin</span>
    </a></li>
  </ul>
</nav>

<!-- Load AFTER your other scripts -->
<script src="/assets/nav.js"></script>

</body>
</html>
