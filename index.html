<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pennyriser — Learn Personal Finance, Simply</title>
  <meta name="description" content="Bite-sized lessons and calculators to master money basics and start investing—clear, practical, no jargon." />
  <link rel="stylesheet" href="/assets/styles.css" />
  <style>
    /* Minimal landing tweaks only */
    .hero {
      min-height: calc(100dvh - 140px);
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      text-align:center; gap:14px; padding:24px 16px;
    }
    .hero h1 { font-size: clamp(28px, 6vw, 44px); margin: 0; }
    .hero p  { font-size: clamp(14px, 2.8vw, 18px); color:#475569; margin: 0 0 8px; }
    .cta-row { display:flex; flex-wrap:wrap; gap:10px; justify-content:center; margin-top:10px; }
    .btn.big { padding: 14px 18px; font-size: 16px; border-radius: 12px; }
    header.container { display:flex; justify-content:space-between; align-items:center; padding:12px 16px; }
    #session a, #session button { font-size: 14px; }
    footer.container { text-align:center; padding:16px; color:#64748b; }
    @media (max-width:720px){ .hero { min-height: calc(100dvh - 180px); } }
  </style>
</head>
<body>
  <!-- Notice -->
  <div class="notice-bar" role="status" aria-live="polite">
    <span id="noticeText" class="notice-text">Education only — not financial advice.</span>
  </div>

  <!-- Top bar kept tiny -->
  <header class="container">
    <div><strong>Pennyriser</strong></div>
    <div id="session" class="small" style="display:flex;gap:8px;align-items:center;">
  <span id="userGreet"></span>
  <a id="loginLink" href="/auth/login.html">Log in / Sign up</a>
  <button id="logoutBtn" class="btn" hidden>Log out</button>
  <a id="adminLink" class="btn" href="/admin/index.html" hidden>Admin</a>
</div>
  </header>

  <!-- Minimal hero -->
  <main class="hero">
    <h1>Learn money. Simply.</h1>
    <p>Personal finance, investing & trading—short lessons and practical tools.</p>
    <div class="cta-row">
  <a class="btn big btn-primary" href="/lessons/index.html">Learn Personal Finance</a>
  <a class="btn big" href="/trading/index.html">Learn Stock Trading</a>
</div>
  </main>

  <footer class="container">
    <p><strong>Disclaimer:</strong> Educational only. Not financial advice.</p>
  </footer>

  <!-- Firebase + Firestore -->
  <script src="/assets/firebase-config.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore-compat.js"></script>

  <!-- Public data (notice) -->
  <script src="/assets/public-data.js"></script>

  <!-- Session state: greet + login/logout + admin -->
  <script>
(function(){
  if (!window.__FIREBASE_CONFIG__ || !window.firebase) return;
  if (!firebase.apps.length) firebase.initializeApp(window.__FIREBASE_CONFIG__);

  const auth = firebase.auth();
  const db   = firebase.firestore();

  const greet     = document.getElementById('userGreet');
  const loginLink = document.getElementById('loginLink');
  const logoutBtn = document.getElementById('logoutBtn');
  const adminLink = document.getElementById('adminLink');

  // Safe initial state (treat as logged out)
  if (greet) greet.textContent = '';
  if (loginLink) loginLink.hidden = false;
  if (logoutBtn) logoutBtn.hidden = true;
  if (adminLink) adminLink.hidden = true;

  async function updateForUser(user){
    if (!user) {
      if (greet) greet.textContent = '';
      if (loginLink) loginLink.hidden = false;
      if (logoutBtn) logoutBtn.hidden = true;
      if (adminLink) adminLink.hidden = true;
      return;
    }

    // Logged-in UI
    if (greet) greet.textContent = 'Hi, ' + (user.email || 'friend');
    if (loginLink) loginLink.hidden = true;
    if (logoutBtn) logoutBtn.hidden = false;
    if (adminLink) adminLink.hidden = true; // keep hidden until role confirmed

    // Show Admin only if role=admin
    try {
      const snap = await db.collection('users').doc(user.uid).get();
      if (snap.exists && snap.data().role === 'admin') {
        if (adminLink) adminLink.hidden = false;
      }
    } catch(e){
      // ignore; keep admin hidden
    }
  }

  auth.onAuthStateChanged(updateForUser);

  logoutBtn?.addEventListener('click', async ()=>{
    try { await auth.signOut(); } finally { location.reload(); }
  });
})();
</script>


  <!-- Optional: bottom nav (keeps mobile flow consistent) -->
  <nav class="bottom-nav" role="navigation" aria-label="Primary">
    <ul>
      <li><a href="/" data-match="/"><span class="icon">🏠</span><span>Home</span></a></li>
      <li><a href="/lessons/index.html" data-match="/lessons/"><span class="icon">📚</span><span>Lessons</span></a></li>
      <li><a href="/calculators/mortgage-overpayment.html" data-match="/calculators/"><span class="icon">🧮</span><span>Calculator</span></a></li>
      <li><a id="bn-login" href="/auth/login.html"><span class="icon">🔑</span><span>Log in</span></a></li>
      <li><a id="bn-logout" href="/auth/login.html" hidden><span class="icon">🚪</span><span>Log out</span></a></li>
      <li><a id="bn-admin" href="/admin/index.html" data-match="/admin/" hidden><span class="icon">🛠️</span><span>Admin</span></a></li>
    </ul>
  </nav>
  <script src="/assets/nav.js"></script>
  <script>
    // Make bottom "Log out" actually sign out
    (function(){
      const btn = document.getElementById('bn-logout');
      if (!btn) return;
      btn.addEventListener('click', function(ev){
        if (!(window.firebase && window.__FIREBASE_CONFIG__)) return;
        ev.preventDefault();
        try {
          if (!firebase.apps.length) firebase.initializeApp(window.__FIREBASE_CONFIG__);
          firebase.auth().signOut().then(()=> location.href='/');
        } catch(e){ location.href='/'; }
      });
    })();
  </script>
  
  
</body>
</html>
